fragment AccessToken on AccessToken {
  id
  insertedAt
  updatedAt
  token
  scopes {
    api
    apis
    identifier
    ids
  }
}

fragment AccessTokenAudit on AccessTokenAudit {
  id
  city
  count
  country
  insertedAt
  ip
  latitude
  longitude
  timestamp
  updatedAt
}

query AccessTokens {
  accessTokens(first: 500) {
    pageInfo {
      ...PageInfo
    }
    edges {
      node {
        ...AccessToken
      }
    }
  }
}

query TokenAudits($id: ID!, $cursor: String) {
  accessToken(id: $id) {
    id
    audits(first: 500, after: $cursor) {
      pageInfo {
        ...PageInfo
      }
      edges {
        node {
          ...AccessTokenAudit
        }
      }
    }
  }
}

mutation CreateAccessToken($scopes: [ScopeAttributes]) {
  createAccessToken(scopes: $scopes) {
    ...AccessToken
  }
}

mutation DeleteAccessToken($token: String!) {
  deleteAccessToken(token: $token) {
    ...AccessToken
  }
}
