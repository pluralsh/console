fragment ServiceDeploymentsRow on ServiceDeployment {
  id
  name
  cluster {
    id
    name
  }
  repository {
    id
    url
  }
  insertedAt
  updatedAt
  componentStatus
  status
}

fragment ServiceDeploymentRevision on Revision {
  id
  version
  updatedAt
  insertedAt
  git {
    folder
    ref
  }
}

fragment ServiceDeploymentRevisions on ServiceDeployment {
  revision {
    ...ServiceDeploymentRevision
  }
  revisions(first: 100) {
    edges {
      node {
        ...ServiceDeploymentRevision
      }
    }
  }
}

query ServiceDeployments {
  serviceDeployments(first: 100) {
    pageInfo {
      ...PageInfo
    }
    edges {
      node {
        ...ServiceDeploymentsRow
      }
    }
  }
}

query ServiceDeploymentRevisions($id: ID!) {
  serviceDeployment(id: $id) {
    ...ServiceDeploymentRevisions
  }
}

mutation CreateServiceDeployment(
  $attributes: ServiceDeploymentAttributes!
  $cluster: String
  $clusterId: ID
) {
  createServiceDeployment(
    attributes: $attributes
    cluster: $cluster
    clusterId: $clusterId
  ) {
    ...ServiceDeploymentsRow
  }
}

mutation DeleteServiceDeployment($id: ID!) {
  deleteServiceDeployment(id: $id) {
    id
  }
}

mutation UpdateServiceDeployment(
  $id: ID!
  $attributes: ServiceUpdateAttributes!
) {
  updateServiceDeployment(id: $id, attributes: $attributes) {
    ...ServiceDeploymentsRow
  }
}

mutation RollbackService($id: ID, $revisionId: ID!) {
  rollbackService(id: $id, revisionId: $revisionId) {
    ...ServiceDeploymentsRow
  }
}
