fragment UpgradeStatistics on UpgradeStatistics {
  upgradeable
  count
  latest
  compliant
}

fragment NodeStatistic on NodeStatistic {
  id
  name
  pendingPods
  health
  cluster {
    id
  }
  insertedAt
  updatedAt
}

fragment ClusterUpgradeDeprecatedCustomResource on DeprecatedCustomResource {
  name
  group
  kind
  namespace
  version
  nextVersion
}

fragment AddonVersionSummary on AddonVersionSummary {
  breakingChanges
  chartUpdates
  features
  helmChanges
}

fragment RuntimeAddonVersion on AddonVersion {
  version
  chartVersion
  images
  releaseUrl
}
fragment RuntimeAddonVersionWithSummary on AddonVersion {
  ...RuntimeAddonVersion
  summary {
    ...AddonVersionSummary
  }
}
fragment CloudAddonVersion on CloudAddonVersionInformation {
  version
}

fragment CloudAddonInformation on CloudAddonInformation {
  name
  publisher
}

fragment RuntimeAddonUpgrade on RuntimeAddonUpgrade {
  addon {
    name
    icon
  }
  callout
  current {
    ...RuntimeAddonVersion
  }
  fix {
    ...RuntimeAddonVersionWithSummary
  }
}

fragment CloudAddonUpgrade on CloudAddonUpgrade {
  addon {
    ...CloudAddon
  }
  current {
    ...CloudAddonVersion
  }
  fix {
    ...CloudAddonVersion
  }
}

fragment ClusterWithUpgrade on Cluster {
  ...ClusterRuntimeServices
  prAutomations {
    id
  }
  deprecatedCustomResources {
    ...ClusterUpgradeDeprecatedCustomResource
  }
  upgradePlanSummary {
    blockingAddons {
      ...RuntimeAddonUpgrade
    }
    blockingCloudAddons {
      ...CloudAddonUpgrade
    }
  }
}

fragment ClusterOverviewDetails on Cluster {
  ...ClustersRow
  ...ClusterWithUpgrade
  ...ClusterInsight
  currentUpgrade {
    ...ClusterUpgrade
  }
  nodeStatistics {
    ...NodeStatistic
  }
}

fragment ClusterHealthScore on Cluster {
  id
  name
  healthScore
}

query ClusterOverviewDetails(
  $id: ID!
  $kubeVersion: String!
  $nextKubeVersion: String!
  $hasKubeVersion: Boolean!
) {
  cluster(id: $id) {
    ...ClusterOverviewDetails
  }
  kubernetesChangelog(version: $nextKubeVersion) @include(if: $hasKubeVersion) {
    version
    majorChanges
    breakingChanges
    deprecations
  }
}

query UpgradeStatistics($projectId: ID, $tag: TagInput) {
  upgradeStatistics(projectId: $projectId, tag: $tag) {
    ...UpgradeStatistics
  }
}

query ClusterHealthScores($projectId: ID) {
  clusters(projectId: $projectId, first: 1000) {
    edges {
      node {
        ...ClusterHealthScore
      }
    }
  }
}
