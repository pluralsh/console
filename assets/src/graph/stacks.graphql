fragment Stack on InfrastructureStack {
  id
  insertedAt
  updatedAt
  name
  type
  configuration {
    image
    version
  }
  repository {
    url
  }
  git {
    ref
    folder
  }
}

fragment StackRun on StackRun {
  id
  status
  approvedAt
  approver {
    name
    email
  }
}

query Stacks($after: String, $before: String, $first: Int = 100, $last: Int) {
  infrastructureStacks(after: $after, before: $before, first: $first, last: $last) {
    pageInfo {
      ...PageInfo
    }
    edges {
      node {
        ...Stack
      }
    }
  }
}

query StackRuns($id: ID!, $after: String, $before: String, $first: Int = 100, $last: Int) {
  infrastructureStack(id: $id) {
    runs(after: $after, before: $before, first: $first, last: $last) {
      pageInfo {
        ...PageInfo
      }
      edges {
        node {
          ...StackRun
        }
      }
    }
  }
}