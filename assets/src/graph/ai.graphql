fragment AiInsight on AiInsight {
  id
  text
  summary
  sha
  freshness
  updatedAt
  insertedAt
  error {
    message
    source
  }
}

fragment AiInsightSummary on AiInsight {
  id
  summary
  freshness
  updatedAt
}

fragment Chat on Chat {
  id
  content
  role
  seq
  insertedAt
  updatedAt
}

fragment ChatThread on ChatThread {
  id
  default
  summary
  insertedAt
  updatedAt
}

query AI($prompt: String!) {
  ai(prompt: $prompt)
}

query AICompletion($system: String!, $input: String, $chat: [ChatMessage]) {
  aiCompletion(system: $system, input: $input, chat: $chat)
}

query AISuggestedFix($insightID: ID!) {
  aiSuggestedFix(insightId: $insightID)
}

query ChatThreads(
  $first: Int = 100
  $last: Int
  $after: String
  $before: String
) {
  chatThreads(first: $first, last: $last, after: $after, before: $before) {
    pageInfo {
      ...PageInfo
    }
    edges {
      node {
        ...ChatThread
      }
    }
  }
}

query Chats(
  $first: Int = 100
  $last: Int
  $after: String
  $before: String
  $threadId: ID
) {
  chats(
    first: $first
    last: $last
    after: $after
    before: $before
    threadId: $threadId
  ) {
    pageInfo {
      ...PageInfo
    }
    edges {
      node {
        ...Chat
      }
    }
  }
}

mutation Chat($messages: [ChatMessage], $threadId: ID) {
  chat(messages: $messages, threadId: $threadId) {
    ...Chat
  }
}

mutation ClearChatHistory($before: Int) {
  clearChatHistory(before: $before)
}

mutation DeleteChat($id: ID!) {
  deleteChat(id: $id) {
    ...Chat
  }
}

mutation SaveChats($messages: [ChatMessage], $threadId: ID) {
  saveChats(messages: $messages, threadId: $threadId) {
    ...Chat
  }
}

mutation CreateChatThread($attributes: ChatThreadAttributes!) {
  createThread(attributes: $attributes) {
    ...ChatThread
  }
}

mutation UpdateChatThread($id: ID!, $attributes: ChatThreadAttributes!) {
  updateThread(id: $id, attributes: $attributes) {
    ...ChatThread
  }
}

mutation DeleteChatThread($id: ID!) {
  deleteThread(id: $id) {
    ...ChatThread
  }
}
