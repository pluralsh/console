fragment AiInsight on AiInsight {
  id
  text
  summary
  sha
  freshness
  updatedAt
  insertedAt
  error {
    message
    source
  }
}

fragment AiInsightSummary on AiInsight {
  id
  summary
  freshness
  updatedAt
}

fragment Chat on Chat {
  id
  content
  role
  seq
  insertedAt
  updatedAt
}

query AI($prompt: String!) {
  ai(prompt: $prompt)
}

query AICompletion($system: String!, $input: String, $chat: [ChatMessage]) {
  aiCompletion(system: $system, input: $input, chat: $chat)
}

query AISuggestedFix($insightID: ID!) {
  aiSuggestedFix(insightId: $insightID)
}

query Chats($first: Int = 100, $last: Int, $after: String, $before: String) {
  chats(first: $first, last: $last, after: $after, before: $before) {
    pageInfo {
      ...PageInfo
    }
    edges {
      node {
        ...Chat
      }
    }
  }
}

mutation Chat($messages: [ChatMessage]) {
  chat(messages: $messages) {
    ...Chat
  }
}

mutation ClearChatHistory($before: Int) {
  clearChatHistory(before: $before)
}

mutation DeleteChat($id: ID!) {
  deleteChat(id: $id) {
    ...Chat
  }
}

mutation SaveChats($messages: [ChatMessage]) {
  saveChats(messages: $messages) {
    ...Chat
  }
}

mutation ClearChatHistory($before: Int, $threadId: ID) {
  clearChatHistory(before: $before, threadId: $threadId)
}
