query ListClusterSentinelRunJobs($after: String, $first: Int, $before: String, $last: Int) {
    clusterSentinelRunJobs(after: $after, first: $first, before: $before, last: $last) {
        pageInfo { ...PageInfoFragment}
        edges {
            node {
                ...SentinelRunJobFragment
            }
        }
    }
}

query GetClusterSentinelRunJob($id: ID!) {
    sentinelRunJob(id: $id) {
        ...SentinelRunJobFragment
    }
}

query GetSentinelRun($id: ID!) {
    sentinelRun(id: $id) {
        ...SentinelRunFragment
    }
}

mutation CreateSentinel($attributes: SentinelAttributes) {
    createSentinel(attributes: $attributes) {
        ...SentinelFragment
    }
}

mutation UpdateSentinel($id: ID!, $attributes: SentinelAttributes) {
    updateSentinel(id: $id, attributes: $attributes) {
        ...SentinelFragment
    }
}

mutation DeleteSentinel($id: ID!) {
    deleteSentinel(id: $id) {
        id
    }
}

query GetSentinel($id: ID!) {
    sentinel(id: $id) {
        ...SentinelFragment
    }
}

fragment SentinelRunJobFragment on SentinelRunJob {
    id
    status
    format
    check
    output
    job {
        ...JobSpecFragment
    }
    reference {
        name
        namespace
    }
    sentinelRun {
        ...SentinelRunFragment
    }
    cluster {
        id
    }
}

fragment SentinelRunFragment on SentinelRun {
    id
    status
    sentinel {
        id
    }
}

fragment SentinelFragment on Sentinel {
    id
    name
    description
    git {
        ...GitRefFragment
    }
    repository {
        ...GitRepositoryFragment
    }
    project {
        ...TinyProjectFragment
    }
    checks {
        ...SentinelCheckFragment
    }

}

fragment SentinelCheckFragment on SentinelCheck {
    id
    name
    type
    ruleFile
    configuration {
        ...SentinelCheckConfigurationFragment
    }
}

fragment SentinelCheckConfigurationFragment on SentinelCheckConfiguration {
    log {
        ...SentinelCheckLogConfigurationFragment
    }
    kubernetes{
        ...SentinelCheckKubernetesConfigurationFragment
    }
}

fragment SentinelCheckLogConfigurationFragment on SentinelCheckLogConfiguration {
    namespaces
    query
    clusterId
    facets {
        key
        value
    }
    duration
}

fragment SentinelCheckKubernetesConfigurationFragment on SentinelCheckKubernetesConfiguration {
    group
    version
    kind
    name
    namespace
}